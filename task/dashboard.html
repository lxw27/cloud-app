<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SubTrack - Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Global styles */
    body {
      background-color: #f0f7ff;
      min-height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    /* Navigation */
    .navbar {
      background-color: white;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }

    .navbar-container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .navbar-content {
      display: flex;
      justify-content: space-between;
      height: 4rem;
    }

    .navbar-left {
      display: flex;
    }

    .brand-logo {
      display: flex;
      align-items: center;
      flex-shrink: 0;
    }

    .brand-name {
      font-size: 1.5rem;
      font-weight: 700;
      color: #3b82f6;
    }

    .nav-links {
      display: none;
      margin-left: 1.5rem;
    }

    @media (min-width: 640px) {
      .nav-links {
        display: flex;
        space-between: 2rem;
      }
    }

    .nav-link {
      display: inline-flex;
      align-items: center;
      padding: 0 0.25rem;
      padding-top: 0.25rem;
      border-bottom: 2px solid transparent;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .nav-link.active {
      border-color: #3b82f6;
      color: #111827;
    }

    .nav-link:not(.active) {
      color: #6b7280;
    }

    .nav-link:not(.active):hover {
      border-color: #d1d5db;
      color: #374151;
    }

    .user-menu {
      display: flex;
      align-items: center;
    }

    .user-name {
      font-size: 0.875rem;
      font-weight: 500;
      color: #4b5563;
      margin-right: 0.5rem;
    }

    .avatar-button {
      background-color: white;
      border-radius: 9999px;
      display: flex;
      font-size: 0.875rem;
      outline: none;
      cursor: pointer;
      border: none;
    }

    .avatar-button:focus {
      outline: none;
      box-shadow: 0 0 0 2px white, 0 0 0 4px #3b82f6;
    }

    .avatar {
      height: 2rem;
      width: 2rem;
      border-radius: 9999px;
    }

    .dropdown-menu {
      position: absolute;
      right: 0;
      margin-top: 0.5rem;
      width: 12rem;
      border-radius: 0.375rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      padding: 0.25rem 0;
      background-color: white;
      border: 1px solid rgba(0, 0, 0, 0.05);
      z-index: 10;
    }

    .dropdown-item {
      display: block;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      color: #4b5563;
      text-decoration: none;
    }

    .dropdown-item:hover {
      background-color: #f3f4f6;
    }

    /* Main content */
    .main-container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 1.5rem 1rem;
    }

    .header-section {
      margin-bottom: 1.5rem;
    }

    @media (min-width: 768px) {
      .header-section {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
    }

    @media (min-width: 640px) {
      .page-title {
        font-size: 1.875rem;
      }
    }

    .page-subtitle {
      margin-top: 0.25rem;
    }

    @media (min-width: 640px) {
      .page-subtitle {
        display: flex;
        flex-wrap: wrap;
        margin-top: 0;
      }
    }

    .subtitle-item {
      display: flex;
      align-items: center;
      margin-top: 0.5rem;
      font-size: 0.875rem;
      color: #6b7280;
    }

    @media (min-width: 640px) {
      .subtitle-item {
        margin-right: 1.5rem;
      }
    }

    .subtitle-icon {
      margin-right: 0.375rem;
      color: #9ca3af;
    }

    .add-button {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      font-size: 0.875rem;
      font-weight: 500;
      color: white;
      background-color: #3b82f6;
      cursor: pointer;
      margin-top: 1rem;
    }

    @media (min-width: 768px) {
      .add-button {
        margin-top: 0;
        margin-left: 1rem;
      }
    }

    .add-button:hover {
      background-color: #2563eb;
    }

    .add-button:focus {
      outline: none;
      box-shadow: 0 0 0 2px white, 0 0 0 4px #3b82f6;
    }

    .add-icon {
      margin-right: 0.5rem;
    }

    /* Filters section */
    .filters-section {
      background-color: white;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
    }

    .filters-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    @media (min-width: 768px) {
      .filters-container {
        flex-direction: row;
        gap: 1rem;
      }
    }

    .search-container {
      flex-grow: 1;
      position: relative;
    }

    .search-icon {
      position: absolute;
      top: 50%;
      left: 0.75rem;
      transform: translateY(-50%);
      color: #9ca3af;
      pointer-events: none;
    }

    .search-input {
      width: 100%;
      padding: 0.5rem 0.75rem 0.5rem 2.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      outline: none;
    }

    .search-input:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
    }

    .filters-controls {
      display: flex;
      gap: 1rem;
    }

    .filter-select {
      padding: 0.5rem 1rem 0.5rem 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      background-color: white;
      color: #6b7280;
      font-size: 0.875rem;
      outline: none;
    }

    .filter-select:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
    }

    .filter-button {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      font-size: 0.875rem;
      font-weight: 500;
      color: #4b5563;
      background-color: white;
      cursor: pointer;
    }

    .filter-button:hover {
      background-color: #f9fafb;
    }

    .filter-button:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
    }

    .filter-icon {
      margin-right: 0.5rem;
    }

    /* Subscriptions table */
    .table-container {
      background-color: white;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border-radius: 0.5rem;
      overflow: hidden;
    }

    .subscriptions-table {
      width: 100%;
      border-collapse: collapse;
    }

    .table-header {
      background-color: #f9fafb;
    }

    .table-heading {
      padding: 0.75rem 1.5rem;
      text-align: left;
      font-size: 0.75rem;
      font-weight: 500;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .table-body {
      background-color: white;
    }

    .table-row {
      border-top: 1px solid #e5e7eb;
    }

    .table-cell {
      padding: 1rem 1.5rem;
      white-space: nowrap;
    }

    .subscription-name-cell {
      display: flex;
      align-items: center;
    }

    .subscription-icon {
      flex-shrink: 0;
      height: 2.5rem;
      width: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #dbeafe;
      color: #3b82f6;
      border-radius: 9999px;
    }

    .subscription-name {
      margin-left: 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      color: #111827;
    }

    .subscription-cost {
      font-size: 0.875rem;
      color: #111827;
    }

    .cost-per-month {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .subscription-cycle {
      font-size: 0.875rem;
      color: #111827;
    }

    .subscription-date {
      font-size: 0.875rem;
      color: #111827;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .status-badge.active {
      background-color: #dcfce7;
      color: #15803d;
    }

    .status-badge.cancelled {
      background-color: #fee2e2;
      color: #b91c1c;
    }

    .action-buttons {
      font-size: 0.875rem;
      font-weight: 500;
    }

    .edit-button {
      color: #3b82f6;
      margin-right: 0.75rem;
      cursor: pointer;
      background: none;
      border: none;
    }

    .edit-button:hover {
      color: #1d4ed8;
    }

    .delete-button {
      color: #ef4444;
      cursor: pointer;
      background: none;
      border: none;
    }

    .delete-button:hover {
      color: #b91c1c;
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.5);
      overflow-y: auto;
      height: 100%;
      width: 100%;
      z-index: 20;
    }

    .modal-container {
      position: relative;
      top: 5rem;
      margin: 0 auto;
      padding: 1.25rem;
      border: 1px solid #e5e7eb;
      width: 100%;
      max-width: 28rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      border-radius: 0.5rem;
      background-color: white;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .modal-title {
      font-size: 1.125rem;
      font-weight: 500;
      color: #111827;
    }

    .modal-close {
      color: #9ca3af;
      cursor: pointer;
      background: none;
      border: none;
    }

    .modal-close:hover {
      color: #6b7280;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: #4b5563;
      margin-bottom: 0.5rem;
    }

    .form-input {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      outline: none;
    }

    .form-input:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
    }

    .cost-input-container {
      position: relative;
    }

    .cost-symbol {
      position: absolute;
      top: 50%;
      left: 0.75rem;
      transform: translateY(-50%);
      pointer-events: none;
      color: #6b7280;
      font-size: 0.875rem;
    }

    .cost-input {
      padding-left: 1.75rem;
    }

    .form-select {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      background-color: white;
      outline: none;
    }

    .form-select:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
    }

    .modal-submit {
      width: 100%;
      display: inline-flex;
      justify-content: center;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      font-size: 0.875rem;
      font-weight: 500;
      color: white;
      background-color: #3b82f6;
      cursor: pointer;
      margin-top: 1.25rem;
    }

    .modal-submit:hover {
      background-color: #2563eb;
    }

    .modal-submit:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
    }

    /* Delete modal */
    .delete-modal-container {
      position: relative;
      top: 5rem;
      margin: 0 auto;
      padding: 1.25rem;
      border: 1px solid #e5e7eb;
      width: 100%;
      max-width: 28rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      border-radius: 0.5rem;
      background-color: white;
    }

    .delete-modal-content {
      margin-top: 0.75rem;
      text-align: center;
    }

    .warning-icon-container {
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 3rem;
      width: 3rem;
      border-radius: 9999px;
      background-color: #fee2e2;
    }

    .warning-icon {
      color: #ef4444;
    }

    .delete-modal-title {
      font-size: 1.125rem;
      font-weight: 500;
      color: #111827;
      margin-top: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .delete-modal-message {
      font-size: 0.875rem;
      color: #6b7280;
      padding: 0.75rem 1.75rem;
    }

    .delete-modal-actions {
      padding: 0.75rem 1rem;
      text-align: center;
    }

    .cancel-button {
      padding: 0.5rem 1rem;
      background-color: #e5e7eb;
      color: #1f2937;
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      border-radius: 0.375rem;
      width: 6rem;
      cursor: pointer;
      margin-right: 0.5rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    }

    .cancel-button:hover {
      background-color: #d1d5db;
    }

    .cancel-button:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(209, 213, 219, 0.5);
    }

    .confirm-delete-button {
      padding: 0.5rem 1rem;
      background-color: #ef4444;
      color: white;
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      border-radius: 0.375rem;
      width: 6rem;
      cursor: pointer;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    }

    .confirm-delete-button:hover {
      background-color: #dc2626;
    }

    .confirm-delete-button:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.5);
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-container">
      <div class="navbar-content">
        <div class="navbar-left">
          <div class="brand-logo">
            <h1 class="brand-name">SubTrack</h1>
          </div>
          <div class="nav-links">
            <a href="#" class="nav-link active">
              Dashboard
            </a>
            <a href="#" class="nav-link">
              Reports
            </a>
            <a href="#" class="nav-link">
              Settings
            </a>
          </div>
        </div>
        <div class="user-menu">
          <div class="relative">
            <div class="flex items-center">
              <span class="user-name">John Doe</span>
              <button id="userMenuButton" class="avatar-button">
                <span class="sr-only">Open user menu</span>
                <img class="avatar" src="https://ui-avatars.com/api/?name=John+Doe&background=3b82f6&color=fff" alt="User avatar">
              </button>
            </div>
            <div id="userMenu" class="dropdown-menu hidden">
              <a href="#" class="dropdown-item">Your Profile</a>
              <a href="#" class="dropdown-item">Settings</a>
              <a href="login.html" class="dropdown-item">Sign out</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Header Section -->
    <div class="header-section">
      <div>
        <h2 class="page-title">
          Your Subscriptions
        </h2>
        <div class="page-subtitle">
          <div class="subtitle-item">
            <i class="fas fa-calendar-alt subtitle-icon"></i>
            Last updated: March 21, 2025
          </div>
          <div class="subtitle-item">
            <i class="fas fa-credit-card subtitle-icon"></i>
            Total monthly: $89.97
          </div>
          <div class="subtitle-item">
            <i class="fas fa-clock subtitle-icon"></i>
            Next renewal: Netflix (Mar 25)
          </div>
        </div>
      </div>
      <div>
        <button type="button" id="openAddModalBtn" class="add-button">
          <i class="fas fa-plus add-icon"></i> Add Subscription
        </button>
      </div>
    </div>

    <!-- Filtering and Search Section -->
    <div class="filters-section">
      <div class="filters-container">
        <div class="search-container">
          <div class="search-icon">
            <i class="fas fa-search"></i>
          </div>
          <input type="text" id="search" class="search-input" placeholder="Search subscriptions...">
        </div>
        <div class="filters-controls">
          <div>
            <label for="status-filter" class="sr-only">Filter by status</label>
            <select id="status-filter" class="filter-select">
              <option value="all">All Status</option>
              <option value="active">Active</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>
          <div>
            <label for="cycle-filter" class="sr-only">Filter by cycle</label>
            <select id="cycle-filter" class="filter-select">
              <option value="all">All Cycles</option>
              <option value="monthly">Monthly</option>
              <option value="yearly">Yearly</option>
            </select>
          </div>
          <button type="button" class="filter-button">
            <i class="fas fa-filter filter-icon"></i>Apply Filters
          </button>
        </div>
      </div>
    </div>

    <!-- Subscription List -->
    <div class="table-container">
      <table class="subscriptions-table">
        <thead class="table-header">
          <tr>
            <th class="table-heading">
              Subscription
            </th>
            <th class="table-heading">
              Cost
            </th>
            <th class="table-heading">
              Billing Cycle
            </th>
            <th class="table-heading">
              Next Renewal
            </th>
            <th class="table-heading">
              Status
            </th>
            <th class="table-heading">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="table-body" id="subscriptionsList">
          <!-- Subscription rows will be populated here -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Add/Edit Subscription Modal -->
  <div id="subscriptionModal" class="modal-overlay hidden">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Add New Subscription</h3>
        <button id="closeModalBtn" class="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="subscriptionForm">
        <input type="hidden" id="subscriptionId" value="">
        <div class="form-group">
          <label for="subscriptionName" class="form-label">Subscription Name</label>
          <input type="text" id="subscriptionName" name="subscriptionName" class="form-input" required>
        </div>
        <div class="form-group">
          <label for="subscriptionCost" class="form-label">Cost</label>
          <div class="cost-input-container">
            <span class="cost-symbol">$</span>
            <input type="number" step="0.01" id="subscriptionCost" name="subscriptionCost" class="form-input cost-input" placeholder="0.00" required>
          </div>
        </div>
        <div class="form-group">
          <label for="billingCycle" class="form-label">Billing Cycle</label>
          <select id="billingCycle" name="billingCycle" class="form-select">
            <option value="monthly">Monthly</option>
            <option value="yearly">Yearly</option>
          </select>
        </div>
        <div class="form-group">
          <label for="nextRenewal" class="form-label">Next Renewal Date</label>
          <input type="date" id="nextRenewal" name="nextRenewal" class="form-input" required>
        </div>
        <div class="form-group">
          <label for="subscriptionStatus" class="form-label">Status</label>
          <select id="subscriptionStatus" name="subscriptionStatus" class="form-select">
            <option value="active">Active</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>
        <button type="submit" class="modal-submit">
          Save Subscription
        </button>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal-overlay hidden">
    <div class="delete-modal-container">
      <div class="delete-modal-content">
        <div class="warning-icon-container">
          <i class="fas fa-exclamation-triangle warning-icon"></i>
        </div>
        <h3 class="delete-modal-title">Delete Subscription</h3>
        <div class="delete-modal-message">
          <p>
            Are you sure you want to delete this subscription? This action cannot be undone.
          </p>
        </div>
        <div class="delete-modal-actions">
          <button id="cancelDeleteBtn" class="cancel-button">
            Cancel
          </button>
          <button id="confirmDeleteBtn" class="confirm-delete-button">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample data for demonstration
    let subscriptions = [
      {
        id: 1,
        name: "Netflix",
        cost: 14.99,
        billingCycle: "monthly",
        nextRenewal: "2025-03-25",
        status: "active"
      },
      {
        id: 2,
        name: "Spotify",
        cost: 9.99,
        billingCycle: "monthly",
        nextRenewal: "2025-04-05",
        status: "active"
      },
      {
        id: 3,
        name: "Amazon Prime",
        cost: 139.00,
        billingCycle: "yearly",
        nextRenewal: "2025-06-15",
        status: "active"
      },
      {
        id: 4,
        name: "New York Times",
        cost: 4.99,
        billingCycle: "monthly",
        nextRenewal: "2025-03-30",
        status: "active"
      },
      {
        id: 5,
        name: "Hulu",
        cost: 11.99,
        billingCycle: "monthly",
        nextRenewal: "2025-04-02",
        status: "cancelled"
      }
    ];

    // DOM Elements
  const subscriptionsList = document.getElementById('subscriptionsList');
  const openAddModalBtn = document.getElementById('openAddModalBtn');
  const closeModalBtn = document.getElementById('closeModalBtn');
  const subscriptionModal = document.getElementById('subscriptionModal');
  const deleteModal = document.getElementById('deleteModal');
  const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
  const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
  const userMenuButton = document.getElementById('userMenuButton');
  const userMenu = document.getElementById('userMenu');
  const modalTitle = document.getElementById('modalTitle');
  const subscriptionForm = document.getElementById('subscriptionForm');
  const subscriptionIdField = document.getElementById('subscriptionId');
  const searchInput = document.getElementById('search');
  const statusFilter = document.getElementById('status-filter');
  const cycleFilter = document.getElementById('cycle-filter');

  // Current subscription being edited or deleted
  let currentSubscriptionId = null;

  // Initialize the page
  document.addEventListener('DOMContentLoaded', function() {
    renderSubscriptions();
    setupEventListeners();
  });

  // Set up all event listeners
  function setupEventListeners() {
    // User menu toggle
    userMenuButton.addEventListener('click', toggleUserMenu);
    document.addEventListener('click', closeUserMenuOnOutsideClick);
    
    // Modal controls
    openAddModalBtn.addEventListener('click', openAddModal);
    closeModalBtn.addEventListener('click', closeModals);
    cancelDeleteBtn.addEventListener('click', closeModals);
    
    // Form submission
    subscriptionForm.addEventListener('submit', handleFormSubmit);
    
    // Delete confirmation
    confirmDeleteBtn.addEventListener('click', deleteSubscription);
    
    // Search and filters
    searchInput.addEventListener('input', filterSubscriptions);
    statusFilter.addEventListener('change', filterSubscriptions);
    cycleFilter.addEventListener('change', filterSubscriptions);
    document.querySelector('.filter-button').addEventListener('click', filterSubscriptions);
  }

  // Toggle user dropdown menu
  function toggleUserMenu() {
    userMenu.classList.toggle('hidden');
  }

  // Close user menu when clicking outside
  function closeUserMenuOnOutsideClick(event) {
    if (!userMenuButton.contains(event.target) && !userMenu.contains(event.target)) {
      userMenu.classList.add('hidden');
    }
  }

  // Render subscriptions list
  function renderSubscriptions(filteredData = null) {
    const data = filteredData || subscriptions;
    subscriptionsList.innerHTML = '';
    
    if (data.length === 0) {
      subscriptionsList.innerHTML = `
        <tr>
          <td colspan="6" class="table-cell text-center">
            No subscriptions found. Add your first subscription to get started!
          </td>
        </tr>
      `;
      return;
    }
    
    data.forEach(subscription => {
      const row = document.createElement('tr');
      row.className = 'table-row';
      
      // Format the date for display
      const nextRenewalDate = new Date(subscription.nextRenewal);
      const formattedDate = nextRenewalDate.toLocaleDateString('en-US', {
        month: 'short',
        day: 'numeric',
        year: 'numeric'
      });
      
      // Create subscription icon based on first letter
      const iconLetter = subscription.name.charAt(0).toUpperCase();
      
      row.innerHTML = `
        <td class="table-cell">
          <div class="subscription-name-cell">
            <div class="subscription-icon">
              <span>${iconLetter}</span>
            </div>
            <span class="subscription-name">${subscription.name}</span>
          </div>
        </td>
        <td class="table-cell">
          <span class="subscription-cost">$${subscription.cost.toFixed(2)}</span>
          <div class="cost-per-month">
            ${subscription.billingCycle === 'yearly' ? 
              `$${(subscription.cost / 12).toFixed(2)}/mo` : ''}
          </div>
        </td>
        <td class="table-cell">
          <span class="subscription-cycle">
            ${subscription.billingCycle.charAt(0).toUpperCase() + subscription.billingCycle.slice(1)}
          </span>
        </td>
        <td class="table-cell">
          <span class="subscription-date">${formattedDate}</span>
        </td>
        <td class="table-cell">
          <span class="status-badge ${subscription.status}">
            ${subscription.status.charAt(0).toUpperCase() + subscription.status.slice(1)}
          </span>
        </td>
        <td class="table-cell">
          <div class="action-buttons">
            <button class="edit-button" data-id="${subscription.id}">
              <i class="fas fa-pencil-alt"></i> Edit
            </button>
            <button class="delete-button" data-id="${subscription.id}">
              <i class="fas fa-trash"></i> Delete
            </button>
          </div>
        </td>
      `;
      
      subscriptionsList.appendChild(row);
    });
    
    // Add event listeners to the action buttons
    document.querySelectorAll('.edit-button').forEach(button => {
      button.addEventListener('click', () => openEditModal(button.dataset.id));
    });
    
    document.querySelectorAll('.delete-button').forEach(button => {
      button.addEventListener('click', () => openDeleteModal(button.dataset.id));
    });
    
    // Update subscription stats
    updateStats();
  }

  // Filter subscriptions based on search and filters
  function filterSubscriptions() {
    const searchTerm = searchInput.value.toLowerCase();
    const statusValue = statusFilter.value;
    const cycleValue = cycleFilter.value;
    
    const filtered = subscriptions.filter(subscription => {
      // Search term filter
      const matchesSearch = subscription.name.toLowerCase().includes(searchTerm);
      
      // Status filter
      const matchesStatus = statusValue === 'all' || subscription.status === statusValue;
      
      // Billing cycle filter
      const matchesCycle = cycleValue === 'all' || subscription.billingCycle === cycleValue;
      
      return matchesSearch && matchesStatus && matchesCycle;
    });
    
    renderSubscriptions(filtered);
  }

  // Update dashboard statistics
  function updateStats() {
    const activeSubscriptions = subscriptions.filter(sub => sub.status === 'active');
    
    // Calculate total monthly cost
    let monthlyTotal = 0;
    
    activeSubscriptions.forEach(sub => {
      if (sub.billingCycle === 'monthly') {
        monthlyTotal += sub.cost;
      } else if (sub.billingCycle === 'yearly') {
        monthlyTotal += sub.cost / 12;
      }
    });
    
    // Update the monthly total in the header
    document.querySelector('.subtitle-item:nth-child(2)').innerHTML = `
      <i class="fas fa-credit-card subtitle-icon"></i>
      Total monthly: $${monthlyTotal.toFixed(2)}
    `;
    
    // Find next renewal
    if (activeSubscriptions.length > 0) {
      const nextRenewal = activeSubscriptions.reduce((earliest, sub) => {
        const renewalDate = new Date(sub.nextRenewal);
        const earliestDate = new Date(earliest.nextRenewal);
        return renewalDate < earliestDate ? sub : earliest;
      }, activeSubscriptions[0]);
      
      const renewalDate = new Date(nextRenewal.nextRenewal);
      const formattedDate = renewalDate.toLocaleDateString('en-US', {
        month: 'short',
        day: 'numeric'
      });
      
      document.querySelector('.subtitle-item:nth-child(3)').innerHTML = `
        <i class="fas fa-clock subtitle-icon"></i>
        Next renewal: ${nextRenewal.name} (${formattedDate})
      `;
    }
    
    // Update last updated date
    const today = new Date();
    const formattedToday = today.toLocaleDateString('en-US', {
      month: 'long',
      day: 'numeric',
      year: 'numeric'
    });
    
    document.querySelector('.subtitle-item:nth-child(1)').innerHTML = `
      <i class="fas fa-calendar-alt subtitle-icon"></i>
      Last updated: ${formattedToday}
    `;
  }

  // Open modal to add new subscription
  function openAddModal() {
    modalTitle.textContent = 'Add New Subscription';
    subscriptionIdField.value = '';
    
    // Reset form fields
    subscriptionForm.reset();
    
    // Set default date to tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('nextRenewal').value = tomorrow.toISOString().split('T')[0];
    
    subscriptionModal.classList.remove('hidden');
  }

  // Open modal to edit subscription
  function openEditModal(id) {
    const subscription = subscriptions.find(sub => sub.id === parseInt(id));
    if (!subscription) return;
    
    modalTitle.textContent = 'Edit Subscription';
    currentSubscriptionId = subscription.id;
    subscriptionIdField.value = subscription.id;
    
    // Populate form fields
    document.getElementById('subscriptionName').value = subscription.name;
    document.getElementById('subscriptionCost').value = subscription.cost;
    document.getElementById('billingCycle').value = subscription.billingCycle;
    document.getElementById('nextRenewal').value = subscription.nextRenewal;
    document.getElementById('subscriptionStatus').value = subscription.status;
    
    subscriptionModal.classList.remove('hidden');
  }

  // Open delete confirmation modal
  function openDeleteModal(id) {
    currentSubscriptionId = parseInt(id);
    deleteModal.classList.remove('hidden');
  }

  // Close all modals
  function closeModals() {
    subscriptionModal.classList.add('hidden');
    deleteModal.classList.add('hidden');
    currentSubscriptionId = null;
  }

  // Handle subscription form submission
  function handleFormSubmit(event) {
    event.preventDefault();
    
    const formData = {
      name: document.getElementById('subscriptionName').value,
      cost: parseFloat(document.getElementById('subscriptionCost').value),
      billingCycle: document.getElementById('billingCycle').value,
      nextRenewal: document.getElementById('nextRenewal').value,
      status: document.getElementById('subscriptionStatus').value
    };
    
    const subscriptionId = subscriptionIdField.value;
    
    if (subscriptionId) {
      // Update existing subscription
      const index = subscriptions.findIndex(sub => sub.id === parseInt(subscriptionId));
      if (index !== -1) {
        subscriptions[index] = { ...subscriptions[index], ...formData };
      }
    } else {
      // Add new subscription
      const newId = subscriptions.length > 0 ? Math.max(...subscriptions.map(sub => sub.id)) + 1 : 1;
      subscriptions.push({ id: newId, ...formData });
    }
    
    renderSubscriptions();
    closeModals();
  }

  // Delete subscription
  function deleteSubscription() {
    if (currentSubscriptionId) {
      subscriptions = subscriptions.filter(sub => sub.id !== currentSubscriptionId);
      renderSubscriptions();
      closeModals();
    }
  }
</script>
</body>
</html>